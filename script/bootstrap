#!/bin/bash
clear
echo "-------------------------------------------------------------------------------------------------------------------------"
echo "Fresh install development enviroment"
echo "Check if you need export http_proxy, before running ;)"
echo "-------------------------------------------------------------------------------------------------------------------------"
#########################################################################################################################
# Install rvm
#########################################################################################################################
if ! command -v rvm &>/dev/null; then
  echo "RVM not found. Installing rvm..."
  bash -s stable < <(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)
  source ~/.bash_profile
  rvm reload
fi
#------------------------------------------------------------------------------------------------------------------------
# Install Ruby
RUBY_VERSION='1.9.2'
GEMSET_NAME='cartolla'

echo "Installing ruby $RUBY_VERSION"
rvm install $RUBY_VERSION
rvm use $RUBY_VERSION

echo "Creating gemset $GEMSET_NAME"
rvm gemset create $GEMSET_NAME
rvm use $RUBY_VERSION@$GEMSET_NAME

echo "rvm use $RUBY_VERSION@$GEMSET_NAME" > .rvmrc
#########################################################################################################################

#########################################################################################################################
# Bundle install
#########################################################################################################################
gem install bundler
bundle install --binstubs --without=production
#########################################################################################################################

#########################################################################################################################
# Database fresh install
#########################################################################################################################
rake db:create
rake db:migrate
#########################################################################################################################

echo "-------------------------------------------------------------------------------------------------------------------------"
echo "Done."
echo "-------------------------------------------------------------------------------------------------------------------------"
